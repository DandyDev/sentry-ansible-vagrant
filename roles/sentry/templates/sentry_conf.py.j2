import os.path

from sentry.conf.server import *

ROOT = os.path.dirname(__file__)

DATABASES = {
    'default': {
        # You can swap out the engine for MySQL easily by changing this value
        # to ``django.db.backends.mysql`` or to PostgreSQL with
        # ``django.db.backends.postgresql_psycopg2``
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': '{{ db_sentry.name }}',
        'USER': '{{ db_sentry.user }}',
        'PASSWORD': '{{ db_sentry.password }}',
        'HOST': 'localhost',
        'PORT': '',
    }
}

BROKER_URL = "redis://"

# Set this to false to require authentication
SENTRY_PUBLIC = False

SENTRY_FEATURES['auth:register'] = False

SENTRY_WEB_HOST = '0.0.0.0'
SENTRY_WEB_PORT = 9000

ALLOWED_HOSTS = ['{{ sentry.server }}']

SENTRY_LOGIN_URL = '{{ sentry.url }}/login/'

SENTRY_OPTIONS['system.url-prefix'] = '{{ sentry.url }}'
SENTRY_OPTIONS['system.secret-key'] = '{{ sentry.secret_key }}'
SENTRY_OPTIONS["redis.clusters"] = {
    'default': {
        'hosts': {
            0: {
                'host': '127.0.0.1',
                'port': 6379,
            }
        }
    }
}

SENTRY_OPTIONS['mail.from'] = '{{ sentry_mail.username }}'
SENTRY_OPTIONS['mail.host'] = '{{ sentry_mail.host }}'
SENTRY_OPTIONS['mail.port'] = {{ sentry_mail.port }}
SENTRY_OPTIONS['mail.username'] = '{{ sentry_mail.username }}'
SENTRY_OPTIONS['mail.password'] = '{{ sentry_mail.password }}'
SENTRY_OPTIONS['mail.use-tls'] = {{ sentry_mail.use_tls }}

CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',
        'LOCATION': ['127.0.0.1:11211'],
    }
}

SENTRY_CACHE = 'sentry.cache.django.DjangoCache'
